<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @meetup.name %>
</p>

<p>
  <strong>Description:</strong>
  <%= @meetup.description %>
</p>

<p>
  <strong>Is commercial trip:</strong>
  <%= @meetup.is_commercial_trip %>
</p>

<p>
  <strong>Street address:</strong>
  <%= @meetup.street_address.titleize %>
</p>

<p>
  <strong>City:</strong>
  <%= @meetup.city.titleize %>
</p>

<p>
  <strong>State:</strong>
  <%= @meetup.state.upcase %>
</p>

<p>
  <strong>Country:</strong>
  <%= @meetup.country.titleize %>
</p>

  <div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>


<p>
  <strong>Is boat required:</strong>
  <%= @meetup.is_boat_required %>
</p>

<p>
  <strong>Price:</strong>
  <%= @meetup.price %>
</p>

<p>
  <strong>Member limit:</strong>
  <%= @meetup.member_limit %>
</p>

<p>
  <strong>Date:</strong>
  <%= @meetup.date %>
</p>

<% is_joined = false%>
<% @meetup.meetupmembers.each do |member| %>
  <% if current_user.id == member.user_id %>
    <% is_joined = true %>
    <% if member.can_edit == true %>
      <%= link_to 'Edit', edit_meetup_path(@meetup) %>
    <% end %>
  <% end  %>
<% end %>

<% if !(is_joined) %>
  <%= link_to 'Would you like to join this meetup?', join_meetup_path(@meetup.id), method: :post %>
<% end %>

<h2>Comments:</h2>
<% @meetup.comments.each do |comment| %>
  <div>
    <h3><%= comment.user.first_name %> <%= comment.user.last_name %></h3>
    <p><%=comment.created_at %></p>
    <p><%= comment.content %></p>
  </div>
<% end %>

<% if is_joined == true %>
  <%= form_for @comment, url: add_comment_path(@meetup.id), :method => :post do |f| %>
    <div class="field">
      <%= f.label :content %>
      <%= f.text_field :content, id: :content %>
    </div>
    <%= f.submit "Add Comment" %>
  <% end %>
<% end %>


<%= link_to 'Back', meetups_path %>

<script type="text/javascript">
handler = Gmaps.build('Google');
handler.buildMap({
   provider: {

   }, 
   internal: {
     id: 'map'
    }
  },
  function(){
  markers = handler.addMarkers([
    {
      "lat": <%= @meetup.latitude %>,
      "lng": <%= @meetup.longitude %>,
      "picture": {
        "url": "http://res.cloudinary.com/chullman/image/upload/v1525666850/map_marker.png",
        "width":  32,
        "height": 32
      },
      "infowindow": "You're meetup location @ <%=@meetup.full_street_address%>"
    }
  ]);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
});
</script>
